#!/usr/bin/perl

# tests Peso Language Pattern Syntax

# ---   *   ---   *   ---
# deps

  use v5.36.0;
  use strict;
  use warnings;

  use English qw(-no_match_vars);

  use lib $ENV{'ARPATH'}.'/avtomat/sys/';

  use Style;
  use Fmat;

  use Tree::Token;

# ---   *   ---   *   ---

my $f    = Tree::Token->get_frame();
my $top  = $f->nit(

  value  => '<TOP>',
  parent => undef,

  action => undef,

);

my $term = $f->nit(

  value  => qr{;},
  parent => $top,

  action => \&Tree::Token::term,

);

# ---   *   ---   *   ---

my $fn=$f->nit(

  value  => 'fn',
  parent => $top,

  action => undef,

);

$f->nit(

  value  => qr{\w+},
  parent => $fn,

  action => \&Tree::Token::push_to_anchor,

);

# ---   *   ---   *   ---

my $value=$f->nit(

  value  => 'value',
  parent => $top,

  action => undef,

);

$f->nit(

  value  => qr{\d+},
  parent => $value,

  action => \&Tree::Token::push_to_anchor,

);

$f->nit(

  value  => qr{,},
  parent => $value,

  action => \&Tree::Token::rew,

);

$top->pushlv($term->dup());

# ---   *   ---   *   ---

my $prog   = 'name 0,1,2;r 43;';
my $result = $top->match($prog);

say "in: $prog\n";
$result->prich();

# ---   *   ---   *   ---
1; # ret
